<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle}">知识图谱系统 - 仪表盘</title>
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.2/css/bootstrap.min.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
    <style>
        :root {
            --sidebar-width: 260px;
            --sidebar-width-collapsed: 70px;
            --topbar-height: 60px;
            --primary-color: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3a0ca3;
            --secondary-color: #4cc9f0;
            --accent-color: #f72585;
            --success-color: #4ade80;
            --warning-color: #fbbf24;
            --danger-color: #f43f5e;
            --dark-color: #0f172a;
            --dark-blue: #1e2a78;
            --light-color: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --box-shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.15);
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), var(--primary-light));
            --gradient-accent: linear-gradient(135deg, var(--accent-color), #b5179e);
            --gradient-dark: linear-gradient(135deg, var(--dark-color), var(--dark-blue));
            --gradient-success: linear-gradient(135deg, var(--success-color), #34d399);
            --card-border-radius: 10px;
            --transition-speed: 0.3s;
            --border-radius: 12px;
        }
        
        body {
            font-family: 'Poppins', 'Noto Sans SC', sans-serif;
            background-color: #f5f7fb;
            background-image: 
                radial-gradient(circle at 95% 5%, rgba(67, 97, 238, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 5% 92%, rgba(76, 201, 240, 0.05) 0%, transparent 25%),
                radial-gradient(circle at 90% 92%, rgba(247, 37, 133, 0.03) 0%, transparent 15%);
            min-height: 100vh;
            margin: 0;
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }
        
        /* 装饰元素 */
        .deco-shape {
            position: fixed;
            z-index: -1;
            border-radius: 50%;
            filter: blur(70px);
            opacity: 0.25;
        }
        
        .deco-shape-1 {
            width: 400px;
            height: 400px;
            background: var(--primary-light);
            top: -200px;
            right: -200px;
        }
        
        .deco-shape-2 {
            width: 300px;
            height: 300px;
            background: var(--secondary-color);
            bottom: -150px;
            left: -150px;
        }
        
        /* 侧边栏样式 */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: white;
            color: var(--gray-700);
            z-index: 1000;
            box-shadow: var(--box-shadow);
            transition: all var(--transition-speed) ease;
            overflow-y: auto;
            overscroll-behavior: contain;
        }
        
        .sidebar.collapsed {
            width: var(--sidebar-width-collapsed);
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .sidebar-header h3 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar.collapsed .sidebar-header h3 {
            display: none;
        }
        
        .sidebar-header h3 i {
            margin-right: 10px;
            font-size: 1.5rem;
            color: var(--secondary-color);
        }
        
        .sidebar-menu {
            padding: 15px 0;
        }
        
        .menu-section {
            margin-bottom: 20px;
        }
        
        .menu-section-title {
            padding: 10px 20px;
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--gray-600);
            font-weight: 500;
        }
        
        .sidebar.collapsed .menu-section-title {
            display: none;
        }
        
        .menu-item {
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--gray-700);
            text-decoration: none;
            transition: all var(--transition-speed) ease;
            border-left: 3px solid transparent;
        }
        
        .menu-item:hover {
            background-color: var(--gray-100);
            color: var(--primary-color);
        }
        
        .menu-item.active {
            background-color: var(--gray-100);
            color: var(--primary-color);
            border-left: 3px solid var(--primary-color);
            font-weight: 500;
        }
        
        .menu-item i {
            font-size: 1.2rem;
            width: 20px;
            text-align: center;
        }
        
        .sidebar.collapsed .menu-item {
            justify-content: center;
            padding: 15px 0;
        }
        
        .sidebar.collapsed .menu-item span {
            display: none;
        }
        
        /* 主内容区域 */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
            transition: all var(--transition-speed) ease;
            background-color: transparent;
            padding-bottom: 30px;
            display: flex;
            flex-direction: column;
        }
        
        .main-content.expanded {
            margin-left: var(--sidebar-width-collapsed);
        }
        
        /* 顶部导航 */
        .top-navbar {
            height: var(--topbar-height);
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .navbar-title {
            display: flex;
            align-items: center;
        }
        
        .navbar-title h4 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .navbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .nav-icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            color: var(--gray-600);
            position: relative;
        }
        
        .nav-icon-btn:hover {
            background-color: var(--gray-100);
            color: var(--primary-color);
        }
        
        .nav-icon-btn .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            border-radius: 50%;
            font-size: 0.6rem;
            min-width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--accent-color);
            box-shadow: 0 4px 6px -1px rgba(247, 37, 133, 0.3);
            font-weight: 600;
        }
        
        .top-navbar .user-dropdown {
            position: relative;
            margin-left: 20px;
        }
        
        .top-navbar .user-dropdown .dropdown-toggle {
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            color: var(--text-primary);
            cursor: pointer;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 10px;
            transition: var(--transition-main);
        }
        
        .top-navbar .user-dropdown .dropdown-toggle:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }
        
        .top-navbar .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 10px;
            font-weight: 600;
            font-size: 1.2rem;
            box-shadow: 0 4px 6px -1px rgba(67, 97, 238, 0.3);
        }
        
        .top-navbar .dropdown-menu {
            padding: 0;
            overflow: hidden;
            min-width: 220px;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: none;
            margin-top: 10px;
        }
        
        .top-navbar .dropdown-header {
            background: var(--gradient-primary);
            color: white;
            padding: 15px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }
        
        .top-navbar .dropdown-item {
            padding: 12px 15px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            transition: var(--transition-main);
        }
        
        .top-navbar .dropdown-item:last-child {
            border-bottom: none;
        }
        
        .top-navbar .dropdown-item i {
            margin-right: 10px;
            font-size: 1.1rem;
            color: var(--text-secondary);
            transition: var(--transition-main);
        }
        
        .top-navbar .dropdown-item:hover {
            background-color: rgba(67, 97, 238, 0.03);
            color: var(--primary-color);
        }
        
        .top-navbar .dropdown-item:hover i {
            color: var(--primary-color);
        }
        
        .top-navbar .dropdown-item.text-danger:hover {
            background-color: rgba(244, 63, 94, 0.05);
            color: var(--danger-color);
        }
        
        .top-navbar .dropdown-item.text-danger:hover i {
            color: var(--danger-color);
        }
        
        /* 内容区域 */
        .content {
            padding: 25px;
        }
        
        .dashboard-title {
            font-weight: 700;
            font-size: 1.8rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }
        
        .dashboard-subtitle {
            color: var(--text-secondary);
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .card {
            border-radius: var(--border-radius);
            border: none;
            box-shadow: var(--card-shadow);
            transition: var(--transition-main);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .card-header {
            background-color: transparent;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .card-header h5 {
            font-weight: 600;
            font-size: 1.1rem;
            margin: 0;
            color: var(--text-primary);
        }
        
        .card-body {
            padding: 25px;
        }
        
        .stat-card {
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            right: -20px;
            top: -20px;
            opacity: 0.05;
            z-index: 0;
        }
        
        .stat-primary::before { background-color: var(--primary-color); }
        .stat-success::before { background-color: var(--success-color); }
        .stat-warning::before { background-color: var(--warning-color); }
        .stat-danger::before { background-color: var(--danger-color); }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            position: relative;
            z-index: 1;
        }
        
        .stat-primary {
            background: var(--gradient-primary);
            color: white;
        }
        
        .stat-success {
            background: var(--gradient-success);
            color: white;
        }
        
        .stat-warning {
            background: linear-gradient(135deg, var(--warning-color), #fb923c);
            color: white;
        }
        
        .stat-danger {
            background: var(--gradient-accent);
            color: white;
        }
        
        .stat-details {
            position: relative;
            z-index: 1;
        }
        
        .stat-details h3 {
            font-size: 2rem;
            margin: 0 0 5px 0;
            font-weight: 700;
            line-height: 1;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-details p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* 知识图谱展示区 */
        .graph-container {
            height: 500px;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--card-shadow);
            position: relative;
        }
        
        /* Chart containers */
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
        }
        
        /* Activity and Recent Access */
        .list-group-item {
            border: none;
            padding: 15px 0;
            background: transparent;
            transition: var(--transition-main);
        }
        
        .list-group-item:not(:last-child) {
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .list-group-item:hover {
            transform: translateX(5px);
        }
        
        .badge {
            padding: 0.5em 0.8em;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 0.5px;
        }
        
        /* 按钮样式 */
        .btn {
            padding: 0.5rem 1.2rem;
            font-weight: 500;
            border-radius: 10px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: var(--transition-main);
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            top: 50%;
            left: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:hover::after {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* 动画效果 */
        @keyframes float {
            0% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-15px);
            }
            100% {
                transform: translateY(0px);
            }
        }
        
        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in-up {
            animation: fade-in-up 0.6s ease forwards;
        }
        
        /* Responsive styles */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .main-content.sidebar-active {
                margin-left: var(--sidebar-width);
            }
            
            .dashboard-cards {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
        }
        
        /* 知识地图样式 */
        .knowledge-map-stage {
            position: relative;
        }
        
        .stage-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #e5e7eb;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
        }
        
        .stage-inner {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #6b7280;
        }
        
        .stage-line {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 3px;
            background-color: #e5e7eb;
            transform: translateY(-50%);
            z-index: 1;
        }
        
        .stage-circle.completed {
            background: linear-gradient(135deg, var(--success-color), #34d399);
        }
        
        .stage-circle.completed .stage-inner {
            background-color: white;
            color: var(--success-color);
        }
        
        .stage-line.completed {
            background-color: var(--success-color);
        }
        
        .stage-circle.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            box-shadow: 0 4px 10px rgba(67, 97, 238, 0.3);
        }
        
        .stage-circle.active .stage-inner {
            background-color: white;
            color: var(--primary-color);
        }
        
        .stage-line.active {
            background: linear-gradient(to right, var(--success-color), var(--primary-color));
        }
        
        /* 按钮样式 */
        .btn-icon {
            width: 30px;
            height: 30px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: var(--text-secondary);
            background-color: transparent;
            border: none;
        }
        
        .btn-icon:hover {
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--primary-color);
        }
        
        /* 悬停高亮效果 */
        .hover-elevate {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-elevate:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            background-color: rgba(67, 97, 238, 0.02);
            border-radius: var(--border-radius);
        }
        
        /* 轮播图自定义样式 */
        .carousel-indicators {
            margin-bottom: 0.5rem;
        }
        
        .carousel-indicators button {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin: 0 4px;
        }
        
        .carousel-control-prev, .carousel-control-next {
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.2);
            top: 50%;
            transform: translateY(-50%);
            border-radius: 50%;
            margin: 0 10px;
            opacity: 0.8;
        }
        
        .carousel-control-prev:hover, .carousel-control-next:hover {
            opacity: 1;
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        /* 旋转动画 */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .spin {
            animation: spin 1.5s linear infinite;
        }

        /* AI助手相关样式 */
        .chat-message {
            margin-bottom: 15px;
        }
        
        .ai-message .message-content {
            background-color: #f8f9fa;
            border-radius: 15px 15px 15px 0;
            display: inline-block;
            max-width: 80%;
        }
        
        .user-message .message-content {
            background-color: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 15px;
            float: right;
        }
        
        .chat-message small {
            display: block;
            clear: both;
            margin-top: 5px;
            font-size: 0.7rem;
        }
        
        #chatInput {
            border-radius: 20px;
        }
        
        #sendMessageBtn {
            border-radius: 50%;
            width: 38px;
            height: 38px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <!-- 装饰形状 -->
    <div class="deco-shape deco-shape-1"></div>
    <div class="deco-shape deco-shape-2"></div>
    
    <!-- 侧边栏 -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3><i class="bi bi-diagram-3-fill"></i> 大数据知识图谱</h3>
            <i class="bi bi-x-lg d-lg-none" id="close-sidebar" style="cursor: pointer;"></i>
        </div>
        
        <div class="sidebar-menu">
            <div class="menu-section">
                <div class="menu-section-title">主要功能</div>
                <a href="/aigraph/dashboard" class="menu-item active">
                    <i class="bi bi-speedometer2"></i>仪表盘
                </a>
                <a href="/aigraph/graph-view" class="menu-item">
                    <i class="bi bi-graph-up"></i>知识图谱
                </a>
                <a href="/aigraph/search" class="menu-item">
                    <i class="bi bi-search"></i>知识检索
                </a>
                <a href="/aigraph/analysis" class="menu-item">
                    <i class="bi bi-diagram-3"></i>关系分析
                </a>
                <a href="/aigraph/visualization" class="menu-item">
                    <i class="bi bi-bar-chart-line"></i>数据可视化
                </a>
            </div>
            
            <div class="menu-section">
                <div class="menu-section-title">学习资源</div>
                <a href="/aigraph/courses" class="menu-item">
                    <i class="bi bi-journal-text"></i>课程内容
                </a>
                <!-- 移除教学案例和学习资料链接 -->
                <a href="/aigraph/qa" class="menu-item">
                    <i class="bi bi-chat-dots"></i>AI智能问答
                </a>
            </div>
            
            <div class="menu-section">
                <div class="menu-section-title">系统管理</div>
                <a href="/aigraph/settings" class="menu-item">
                    <i class="bi bi-gear"></i>系统设置
                </a>
                <a href="/aigraph/profile" class="menu-item">
                    <i class="bi bi-person"></i>个人中心
                </a>
                <a href="/aigraph/logout" class="menu-item">
                    <i class="bi bi-box-arrow-right"></i>退出登录
                </a>
            </div>
        </div>
    </div>
    
    <!-- 主内容区域 -->
    <div class="main-content" id="main-content">
        <!-- 顶部导航栏 -->
        <div class="top-navbar">
            <!-- 删除toggle-sidebar按钮 -->
            
            <div class="navbar-title">
                <h4>系统仪表盘</h4>
            </div>
            
            <div class="navbar-right">
                <div class="nav-icon-btn" title="消息通知">
                    <i class="bi bi-bell"></i>
                    <span class="badge bg-danger">3</span>
                </div>
                
                <!-- 移除了学习助手按钮 -->
                
                <div class="user-dropdown dropdown">
                    <button class="dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        <div class="user-avatar" th:text="${#strings.substring(username, 0, 1).toUpperCase()}">A</div>
                        <span th:text="${username}">用户名</span>
                        <i class="bi bi-chevron-down ms-2"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                        <li>
                            <div class="dropdown-header">
                                <strong th:text="${username}">用户名</strong>
                                <p class="mb-0">管理员</p>
                            </div>
                        </li>
                        <li><a class="dropdown-item" href="/aigraph/profile" id="profileLink"><i class="bi bi-person"></i> 个人资料</a></li>
                        <li><a class="dropdown-item" href="/aigraph/settings" id="settingsLink"><i class="bi bi-gear"></i> 账号设置</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="/aigraph/logout"><i class="bi bi-box-arrow-right"></i> 退出登录</a></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 内容区域 -->
        <div class="content">
            <div class="container-fluid">
                <div class="row mb-4" data-aos="fade-up" data-aos-duration="800">
                    <div class="col">
                        <h2 class="dashboard-title">大数据技术课程仪表盘</h2>
                        <p class="dashboard-subtitle">欢迎使用大数据课程知识图谱系统，探索知识的连接与拓展</p>
                    </div>
                </div>
                
                <!-- 统计卡片 -->
                <div class="dashboard-cards">
                    <div class="card fade-in-up" data-aos="fade-up" data-aos-delay="100">
                        <div class="card-body">
                            <div class="stat-card stat-primary">
                                <div class="stat-icon">
                                    <i class="bi bi-graph-up"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="counter-animation text-white">245</h3>
                                    <p>知识节点</p>
                                    <div class="progress mt-2" style="height: 5px;">
                                        <div class="progress-bar" role="progressbar" style="width: 78%; background: var(--gradient-primary);" aria-valuenow="78" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <small class="text-muted mt-1 d-block">较上月增长 12%</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card fade-in-up" data-aos="fade-up" data-aos-delay="200">
                        <div class="card-body">
                            <div class="stat-card stat-success">
                                <div class="stat-icon">
                                    <i class="bi bi-link-45deg"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="counter-animation text-white">312</h3>
                                    <p>关系连接</p>
                                    <div class="progress mt-2" style="height: 5px;">
                                        <div class="progress-bar" role="progressbar" style="width: 65%; background: var(--gradient-success);" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <small class="text-muted mt-1 d-block">较上月增长 8%</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card fade-in-up" data-aos="fade-up" data-aos-delay="300">
                        <div class="card-body">
                            <div class="stat-card stat-warning">
                                <div class="stat-icon">
                                    <i class="bi bi-journal-text"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="counter-animation text-white">18</h3>
                                    <p>课程章节</p>
                                    <div class="progress mt-2" style="height: 5px;">
                                        <div class="progress-bar" role="progressbar" style="width: 90%; background: linear-gradient(135deg, var(--warning-color), #fb923c);" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <small class="text-muted mt-1 d-block">学期进度 90%</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card fade-in-up" data-aos="fade-up" data-aos-delay="400">
                        <div class="card-body">
                            <div class="stat-card stat-danger">
                                <div class="stat-icon">
                                    <i class="bi bi-clock-history"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="counter-animation text-white">152</h3>
                                    <p>学习记录</p>
                                    <div class="progress mt-2" style="height: 5px;">
                                        <div class="progress-bar" role="progressbar" style="width: 42%; background: var(--gradient-accent);" aria-valuenow="42" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <small class="text-muted mt-1 d-block">近7天新增 42%</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 知识图谱展示区 -->
                <div class="row">
                    <div class="col-12" data-aos="zoom-in" data-aos-delay="100">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">知识图谱预览</h5>
                                <!-- 删除全屏查看按钮 -->
                            </div>
                            <div class="card-body p-0">
                                <div class="graph-container" id="knowledge-graph">
                                    <!-- 这里将使用D3.js渲染知识图谱 -->
                                    <div class="graph-loading position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-white bg-opacity-75" style="z-index: 1;">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">加载中...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 图表区域 -->
                <div class="row">
                    <div class="col-lg-6" data-aos="fade-right" data-aos-delay="100">
                        <div class="card mb-4 h-100">
                            <div class="card-header">
                                <h5 class="mb-0">学习进度</h5>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-light dropdown-toggle" type="button" id="progressTimeRange" data-bs-toggle="dropdown" aria-expanded="false">
                                        最近6个月
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="progressTimeRange">
                                        <li><a class="dropdown-item" href="#" data-time-range="30days">最近30天</a></li>
                                        <li><a class="dropdown-item" href="#" data-time-range="3months">最近3个月</a></li>
                                        <li><a class="dropdown-item active" href="#" data-time-range="6months">最近6个月</a></li>
                                        <li><a class="dropdown-item" href="#" data-time-range="1year">全年</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-4">
                                    <div>
                                        <h3 class="mb-0">65</h3>
                                        <p class="text-muted mb-0">学习知识点</p>
                                    </div>
                                    <div class="text-end">
                                        <span class="badge bg-success">+22%</span>
                                        <p class="text-muted mb-0">较上期</p>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="learningProgressChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6" data-aos="fade-left" data-aos-delay="200">
                        <div class="card mb-4 h-100">
                            <div class="card-header">
                                <h5 class="mb-0">知识点分布</h5>
                                <div>
                                    <button class="btn btn-sm btn-light" id="refreshDistributionChart">
                                        <i class="bi bi-arrow-repeat"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body d-flex flex-column">
                                <div class="chart-container flex-grow-1 d-flex align-items-center">
                                    <canvas id="knowledgeDistributionChart"></canvas>
                                </div>
                                <div class="chart-legend d-flex justify-content-center flex-wrap mt-3">
                                    <div class="px-3 py-1 d-flex align-items-center">
                                        <span class="legend-color me-2" style="width:12px;height:12px;border-radius:50%;background:var(--primary-color)"></span>
                                        <span class="small">基础理论 (30%)</span>
                                    </div>
                                    <div class="px-3 py-1 d-flex align-items-center">
                                        <span class="legend-color me-2" style="width:12px;height:12px;border-radius:50%;background:var(--secondary-color)"></span>
                                        <span class="small">技术原理 (25%)</span>
                                    </div>
                                    <div class="px-3 py-1 d-flex align-items-center">
                                        <span class="legend-color me-2" style="width:12px;height:12px;border-radius:50%;background:var(--danger-color)"></span>
                                        <span class="small">实践案例 (15%)</span>
                                    </div>
                                    <div class="px-3 py-1 d-flex align-items-center">
                                        <span class="legend-color me-2" style="width:12px;height:12px;border-radius:50%;background:var(--success-color)"></span>
                                        <span class="small">技术方法 (20%)</span>
                                    </div>
                                    <div class="px-3 py-1 d-flex align-items-center">
                                        <span class="legend-color me-2" style="width:12px;height:12px;border-radius:50%;background:var(--warning-color)"></span>
                                        <span class="small">应用领域 (10%)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6" data-aos="fade-up" data-aos-delay="300">
                        <div class="card mb-4 h-100">
                            <div class="card-header">
                                <h5 class="mb-0">学习趋势</h5>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active" data-trend-view="week">周</button>
                                    <button class="btn btn-sm btn-outline-primary" data-trend-view="month">月</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-4">
                                    <div>
                                        <h3 class="mb-0">23.4</h3>
                                        <p class="text-muted mb-0">总学习时长 (小时)</p>
                                    </div>
                                    <div class="text-end">
                                        <span class="badge bg-danger">-5%</span>
                                        <p class="text-muted mb-0">较上周</p>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="learningTrendChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6" data-aos="fade-up" data-aos-delay="400">
                        <div class="card mb-4 h-100">
                            <div class="card-header">
                                <h5 class="mb-0">学习内容类型</h5>
                                <!-- 删除查看详情按钮 -->
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="learningTypeChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 活动记录和最近访问 -->
                <div class="row">
                    <div class="col-lg-6" data-aos="fade-up" data-aos-delay="100">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">最近活动</h5>
                                <!-- 删除查看全部按钮 -->
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item px-0">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle" style="background-color: rgba(67, 97, 238, 0.1);">
                                                <i class="bi bi-search text-primary"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0 fw-medium">搜索关键词 "分布式存储原理"</p>
                                                <small class="text-muted d-flex align-items-center">
                                                    <i class="bi bi-clock me-1" style="font-size: 0.7rem;"></i>
                                                    今天 10:45
                                                </small>
                                            </div>
                                            <div>
                                                <button class="btn btn-sm btn-icon" title="再次查看">
                                                    <i class="bi bi-arrow-repeat"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle" style="background-color: rgba(74, 222, 128, 0.1);">
                                                <i class="bi bi-eye text-success"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0 fw-medium">查看实体 "HDFS架构"</p>
                                                <small class="text-muted d-flex align-items-center">
                                                    <i class="bi bi-clock me-1" style="font-size: 0.7rem;"></i>
                                                    今天 09:30
                                                </small>
                                            </div>
                                            <div>
                                                <button class="btn btn-sm btn-icon" title="再次查看">
                                                    <i class="bi bi-arrow-up-right-square"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle" style="background-color: rgba(76, 201, 240, 0.1);">
                                                <i class="bi bi-book text-info"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0 fw-medium">访问章节 "分布式存储系统"</p>
                                                <small class="text-muted d-flex align-items-center">
                                                    <i class="bi bi-clock me-1" style="font-size: 0.7rem;"></i>
                                                    昨天 16:20
                                                </small>
                                            </div>
                                            <div>
                                                <button class="btn btn-sm btn-icon" title="再次查看">
                                                    <i class="bi bi-arrow-up-right-square"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle" style="background-color: rgba(251, 191, 36, 0.1);">
                                                <i class="bi bi-download text-warning"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <p class="mb-0 fw-medium">导出图谱数据</p>
                                                <small class="text-muted d-flex align-items-center">
                                                    <i class="bi bi-clock me-1" style="font-size: 0.7rem;"></i>
                                                    昨天 14:05
                                                </small>
                                            </div>
                                            <div>
                                                <button class="btn btn-sm btn-icon" title="再次导出">
                                                    <i class="bi bi-download"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6" data-aos="fade-up" data-aos-delay="200">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">热门知识点</h5>
                                <div>
                                    <select class="form-select form-select-sm" style="width: auto" id="hotKnowledgeTimeRange">
                                        <option value="week" selected>本周</option>
                                        <option value="month">本月</option>
                                        <option value="all">全部</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush" id="hotKnowledgeList">
                                    <li class="list-group-item px-0">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <div class="me-3 text-center" style="width: 30px;">
                                                    <span class="badge rounded-pill bg-primary">1</span>
                                                </div>
                                            <div>
                                                    <h6 class="mb-0 fw-semibold">分布式存储</h6>
                                                <small class="text-muted">相关实体: 38个</small>
                                            </div>
                                            </div>
                                            <div class="text-end">
                                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">89次访问</span>
                                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                                    <div class="progress-bar" role="progressbar" style="width: 100%; background: var(--gradient-primary);" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <div class="me-3 text-center" style="width: 30px;">
                                                    <span class="badge rounded-pill bg-primary">2</span>
                                                </div>
                                            <div>
                                                    <h6 class="mb-0 fw-semibold">HDFS架构</h6>
                                                <small class="text-muted">相关实体: 24个</small>
                                            </div>
                                            </div>
                                            <div class="text-end">
                                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">76次访问</span>
                                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                                    <div class="progress-bar" role="progressbar" style="width: 85%; background: var(--gradient-primary);" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <div class="me-3 text-center" style="width: 30px;">
                                                    <span class="badge rounded-pill bg-primary">3</span>
                                                </div>
                                            <div>
                                                    <h6 class="mb-0 fw-semibold">数据处理</h6>
                                                <small class="text-muted">相关实体: 31个</small>
                                            </div>
                                            </div>
                                            <div class="text-end">
                                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">68次访问</span>
                                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                                    <div class="progress-bar" role="progressbar" style="width: 76%; background: var(--gradient-primary);" aria-valuenow="76" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <div class="me-3 text-center" style="width: 30px;">
                                                    <span class="badge rounded-pill bg-primary">4</span>
                                                </div>
                                            <div>
                                                    <h6 class="mb-0 fw-semibold">分布式计算</h6>
                                                <small class="text-muted">相关实体: 19个</small>
                                            </div>
                                            </div>
                                            <div class="text-end">
                                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">52次访问</span>
                                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                                    <div class="progress-bar" role="progressbar" style="width: 58%; background: var(--gradient-primary);" aria-valuenow="58" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-footer bg-transparent border-0 text-center">
                                <!-- 删除查看更多知识点按钮 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

                <!-- 知识地图 -->
                <div class="row" data-aos="fade-up" data-aos-delay="300">
                    <div class="col-12">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">课程知识地图</h5>
                                <div>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline-primary active">阶段视图</button>
                                        <button class="btn btn-sm btn-outline-primary">主题视图</button>
        </div>
                                </div>
                            </div>
                            <div class="card-body p-3">
                                <div class="knowledge-map">
                                    <div class="d-flex align-items-center overflow-auto py-2" style="min-height: 180px;">
                                        <div class="knowledge-map-stage flex-shrink-0 me-4 text-center">
                                            <div class="stage-circle completed">
                                                <div class="stage-inner">
                                                    <i class="bi bi-check-lg"></i>
                                                </div>
                                            </div>
                                            <div class="stage-line completed"></div>
                                            <small class="d-block mt-2">基础知识</small>
    </div>
                                        
                                        <div class="knowledge-map-stage flex-shrink-0 me-4 text-center">
                                            <div class="stage-circle completed">
                                                <div class="stage-inner">
                                                    <i class="bi bi-check-lg"></i>
                                                </div>
                                            </div>
                                            <div class="stage-line completed"></div>
                                            <small class="d-block mt-2">分布式存储系统</small>
                                        </div>
                                        
                                        <div class="knowledge-map-stage flex-shrink-0 me-4 text-center">
                                            <div class="stage-circle active">
                                                <div class="stage-inner">
                                                    <span>3</span>
                                                </div>
                                            </div>
                                            <div class="stage-line active"></div>
                                            <small class="d-block mt-2">分布式计算</small>
                                        </div>
                                        
                                        <div class="knowledge-map-stage flex-shrink-0 me-4 text-center">
                                            <div class="stage-circle">
                                                <div class="stage-inner">
                                                    <span>4</span>
                                                </div>
                                            </div>
                                            <div class="stage-line"></div>
                                            <small class="d-block mt-2">分布式存储</small>
                                        </div>
                                        
                                        <div class="knowledge-map-stage flex-shrink-0 me-4 text-center">
                                            <div class="stage-circle">
                                                <div class="stage-inner">
                                                    <span>5</span>
                                                </div>
                                            </div>
                                            <div class="stage-line"></div>
                                            <small class="d-block mt-2">HDFS架构</small>
                                        </div>
                                        
                                        <div class="knowledge-map-stage flex-shrink-0 me-4 text-center">
                                            <div class="stage-circle">
                                                <div class="stage-inner">
                                                    <span>6</span>
                                                </div>
                                            </div>
                                            <div class="stage-line"></div>
                                            <small class="d-block mt-2">MapReduce</small>
                                        </div>
                                        
                                        <div class="knowledge-map-stage flex-shrink-0 text-center">
                                            <div class="stage-circle">
                                                <div class="stage-inner">
                                                    <span>7</span>
                                                </div>
                                            </div>
                                            <small class="d-block mt-2">数据湖</small>
                                        </div>
                                    </div>
                                    
                                    <div class="knowledge-map-info p-3 mt-3 rounded-3" style="background-color: rgba(67, 97, 238, 0.05); border-left: 4px solid var(--primary-color);">
                                        <div class="d-flex align-items-center">
                                            <div class="stage-circle active me-3" style="width: 40px; height: 40px;">
                                                <div class="stage-inner">
                                                    <span>3</span>
                                                </div>
                                            </div>
                                            <div>
                                                <h6 class="mb-1">当前阶段: 分布式计算</h6>
                                                <p class="mb-0 text-muted">已完成 4/12 节课程 (33%)</p>
                                            </div>
                                            <div class="ms-auto">
                                                <button class="btn btn-primary btn-sm">继续学习</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 新增: 高级数据分析区 -->
                <div class="row">
                    <div class="col-12">
                        <h4 class="mb-4 fw-bold" data-aos="fade-up">高级数据分析</h4>
                    </div>
                </div>
                
                <!-- 新增: 两栏布局区域 -->
                <div class="row">
                    <!-- 左侧主要图表区域 -->
                    <div class="col-lg-8" data-aos="fade-up" data-aos-delay="100">
                        <!-- 学习效率比较图表 -->
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">学习效率比较</h5>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active" data-period="week">按周</button>
                                    <button class="btn btn-sm btn-outline-primary" data-period="month">按月</button>
                                    <button class="btn btn-sm btn-outline-primary" data-period="year">按年</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-4">
                                    <div>
                                        <h3 class="mb-0" id="efficiency-value">85.2%</h3>
                                        <p class="text-muted mb-0">学习效率指数</p>
                                    </div>
                                    <div class="text-end">
                                        <span class="badge bg-success" id="efficiency-change">+8.5%</span>
                                        <p class="text-muted mb-0" id="efficiency-period">较上周</p>
                                    </div>
                                </div>
                                <div class="chart-container" style="height: 300px;">
                                    <canvas id="learningEfficiencyChart" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 知识点类型分布 -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">知识点类型分布</h5>
                                <div>
                                    <button class="btn btn-sm btn-light" id="refreshKnowledgeTypeChart">
                                        <i class="bi bi-arrow-repeat"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="chart-container" style="height: 300px;">
                                            <canvas id="knowledgeTypeDistributionChart" height="300"></canvas>
                                        </div>
                                    </div>
                                    <div class="col-md-4 d-flex flex-column justify-content-center">
                                        <div class="px-3 py-2 rounded-3 mb-3" style="background-color: rgba(67, 97, 238, 0.1);">
                                            <h6 class="fw-semibold mb-1">技术方法</h6>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span class="fw-bold fs-5">42%</span>
                                                <span class="badge bg-success">热门</span>
                                            </div>
                                            <div class="progress mt-2" style="height: 5px;">
                                                <div class="progress-bar" role="progressbar" style="width: 42%; background: var(--gradient-primary);" aria-valuenow="42" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="px-3 py-2 rounded-3 mb-3" style="background-color: rgba(76, 201, 240, 0.1);">
                                            <h6 class="fw-semibold mb-1">基础理论</h6>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span class="fw-bold fs-5">30%</span>
                                                <span class="badge bg-secondary">必修</span>
                                            </div>
                                            <div class="progress mt-2" style="height: 5px;">
                                                <div class="progress-bar" role="progressbar" style="width: 30%; background: var(--gradient-secondary);" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                        <div class="px-3 py-2 rounded-3" style="background-color: rgba(247, 37, 133, 0.1);">
                                            <h6 class="fw-semibold mb-1">实践案例</h6>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span class="fw-bold fs-5">28%</span>
                                                <span class="badge bg-warning">增长中</span>
                                            </div>
                                            <div class="progress mt-2" style="height: 5px;">
                                                <div class="progress-bar" role="progressbar" style="width: 28%; background: var(--gradient-accent);" aria-valuenow="28" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 年度学习趋势 -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">年度学习趋势</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container" style="height: 300px;">
                                    <canvas id="yearlyLearningTrendChart" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧边栏 -->
                    <div class="col-lg-4" data-aos="fade-up" data-aos-delay="150">
                        <!-- 快捷操作区 -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="bi bi-lightning-charge me-2 text-warning"></i>快捷操作
                                </h5>
                            </div>
                            <div class="card-body p-0">
                                <a href="/aigraph/graph-view" class="d-flex align-items-center p-3 text-decoration-none text-dark border-bottom hover-elevate">
                                    <div class="me-3 p-2 rounded-circle bg-primary bg-opacity-10">
                                        <i class="bi bi-diagram-3 text-primary"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">查看知识图谱</h6>
                                        <p class="text-muted mb-0 small">可视化浏览全部知识点</p>
                                    </div>
                                    <i class="bi bi-chevron-right ms-auto"></i>
                                </a>
                                <a href="/aigraph/search" class="d-flex align-items-center p-3 text-decoration-none text-dark border-bottom hover-elevate">
                                    <div class="me-3 p-2 rounded-circle bg-success bg-opacity-10">
                                        <i class="bi bi-search text-success"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">智能检索</h6>
                                        <p class="text-muted mb-0 small">快速查找相关知识点</p>
                                    </div>
                                    <i class="bi bi-chevron-right ms-auto"></i>
                                </a>
                                <a href="/aigraph/courses" class="d-flex align-items-center p-3 text-decoration-none text-dark border-bottom hover-elevate">
                                    <div class="me-3 p-2 rounded-circle bg-danger bg-opacity-10">
                                        <i class="bi bi-journal-text text-danger"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">课程导航</h6>
                                        <p class="text-muted mb-0 small">浏览所有课程内容</p>
                                    </div>
                                    <i class="bi bi-chevron-right ms-auto"></i>
                                </a>
                                <a href="/aigraph/analysis" class="d-flex align-items-center p-3 text-decoration-none text-dark hover-elevate">
                                    <div class="me-3 p-2 rounded-circle bg-info bg-opacity-10">
                                        <i class="bi bi-graph-up text-info"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">关系分析</h6>
                                        <p class="text-muted mb-0 small">探索知识点间的关联</p>
                                    </div>
                                    <i class="bi bi-chevron-right ms-auto"></i>
                                </a>
                                <a href="/aigraph/visualization" class="d-flex align-items-center p-3 text-decoration-none text-dark hover-elevate">
                                    <div class="me-3 p-2 rounded-circle bg-success bg-opacity-10">
                                        <i class="bi bi-bar-chart-line text-success"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-1">数据可视化</h6>
                                        <p class="text-muted mb-0 small">探索数据背后的故事</p>
                                    </div>
                                    <i class="bi bi-chevron-right ms-auto"></i>
                                </a>
                            </div>
                        </div>
                        
                        <!-- 最近访问记录 -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="bi bi-clock-history me-2 text-primary"></i>最近访问
                                </h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="list-group list-group-flush">
                                    <a href="#" class="list-group-item list-group-item-action p-3 hover-elevate">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle bg-primary bg-opacity-10">
                                                <i class="bi bi-book text-primary"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">分布式存储系统原理</h6>
                                                <p class="mb-0 text-muted small"><i class="bi bi-clock-history me-1"></i>今天 14:30</p>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action p-3 hover-elevate">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle bg-success bg-opacity-10">
                                                <i class="bi bi-file-code text-success"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">Hadoop生态系统代码实现</h6>
                                                <p class="mb-0 text-muted small"><i class="bi bi-clock-history me-1"></i>昨天 11:45</p>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action p-3 hover-elevate">
                                        <div class="d-flex align-items-center">
                                            <div class="me-3 p-2 rounded-circle bg-warning bg-opacity-10">
                                                <i class="bi bi-diagram-3 text-warning"></i>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">知识图谱可视化</h6>
                                                <p class="mb-0 text-muted small"><i class="bi bi-clock-history me-1"></i>3天前</p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 学习资讯轮播图 -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="bi bi-info-circle me-2 text-info"></i>学习资讯
                                </h5>
                            </div>
                            <div class="card-body p-0">
                                <div id="learningNewsCarousel" class="carousel slide" data-bs-ride="carousel">
                                    <div class="carousel-indicators">
                                        <button type="button" data-bs-target="#learningNewsCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                                        <button type="button" data-bs-target="#learningNewsCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                                        <button type="button" data-bs-target="#learningNewsCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                                    </div>
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <div class="position-relative" style="height: 200px; background: linear-gradient(135deg, #4361ee, #3a0ca3);">
                                                <div class="position-absolute top-0 start-0 w-100 h-100 p-4 d-flex flex-column justify-content-end text-white">
                                                    <div class="position-absolute top-0 end-0 p-2">
                                                        <span class="badge bg-danger">新增</span>
                                                    </div>
                                                    <h5>最新分布式存储课程上线</h5>
                                                    <p class="mb-2">探索HDFS架构及其应用</p>
                                                    <button class="btn btn-sm btn-light align-self-start">立即学习</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="carousel-item">
                                            <div class="position-relative" style="height: 200px; background: linear-gradient(135deg, #f72585, #b5179e);">
                                                <div class="position-absolute top-0 start-0 w-100 h-100 p-4 d-flex flex-column justify-content-end text-white">
                                                    <h5>AI竞赛月开始报名</h5>
                                                    <p class="mb-2">参与竞赛，赢取丰厚奖励</p>
                                                    <button class="btn btn-sm btn-light align-self-start">查看详情</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="carousel-item">
                                            <div class="position-relative" style="height: 200px; background: linear-gradient(135deg, #06d6a0, #018786);">
                                                <div class="position-absolute top-0 start-0 w-100 h-100 p-4 d-flex flex-column justify-content-end text-white">
                                                    <h5>知识图谱技术讲座</h5>
                                                    <p class="mb-2">与行业专家在线交流学习</p>
                                                    <button class="btn btn-sm btn-light align-self-start">预约参加</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="carousel-control-prev" type="button" data-bs-target="#learningNewsCarousel" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button" data-bs-target="#learningNewsCarousel" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 学习排行榜 -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="bi bi-trophy me-2 text-warning"></i>学习排行榜
                                </h5>
                            </div>
                            <div class="card-body p-0">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item p-3">
                                        <div class="d-flex align-items-center">
                                            <div class="ranking-badge me-3 bg-warning text-white rounded-circle d-flex align-items-center justify-content-center fw-bold" style="width: 30px; height: 30px;">1</div>
                                            <div class="avatar me-3 rounded-circle bg-primary d-flex align-items-center justify-content-center text-white" style="width: 40px; height: 40px;">
                                                <span>Z</span>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">张三</h6>
                                                <p class="mb-0 text-muted small">学习时长: 45小时</p>
                                            </div>
                                            <div class="points-badge rounded-pill py-1 px-2 bg-light text-primary fw-semibold">890分</div>
                                        </div>
                                    </li>
                                    <li class="list-group-item p-3">
                                        <div class="d-flex align-items-center">
                                            <div class="ranking-badge me-3 bg-secondary text-white rounded-circle d-flex align-items-center justify-content-center fw-bold" style="width: 30px; height: 30px;">2</div>
                                            <div class="avatar me-3 rounded-circle bg-info d-flex align-items-center justify-content-center text-white" style="width: 40px; height: 40px;">
                                                <span>L</span>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">李四</h6>
                                                <p class="mb-0 text-muted small">学习时长: 42小时</p>
                                            </div>
                                            <div class="points-badge rounded-pill py-1 px-2 bg-light text-primary fw-semibold">856分</div>
                                        </div>
                                    </li>
                                    <li class="list-group-item p-3">
                                        <div class="d-flex align-items-center">
                                            <div class="ranking-badge me-3 bg-danger text-white rounded-circle d-flex align-items-center justify-content-center fw-bold" style="width: 30px; height: 30px;">3</div>
                                            <div class="avatar me-3 rounded-circle bg-success d-flex align-items-center justify-content-center text-white" style="width: 40px; height: 40px;">
                                                <span>W</span>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">王五</h6>
                                                <p class="mb-0 text-muted small">学习时长: 38小时</p>
                                            </div>
                                            <div class="points-badge rounded-pill py-1 px-2 bg-light text-primary fw-semibold">819分</div>
                                        </div>
                                    </li>
                                    <li class="list-group-item p-3 bg-light">
                                        <div class="d-flex align-items-center">
                                            <div class="ranking-badge me-3 bg-primary text-white rounded-circle d-flex align-items-center justify-content-center fw-bold" style="width: 30px; height: 30px;">8</div>
                                            <div class="avatar me-3 rounded-circle bg-warning d-flex align-items-center justify-content-center text-white" style="width: 40px; height: 40px;">
                                                <span th:text="${#strings.substring(username, 0, 1).toUpperCase()}">Y</span>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-0 fw-semibold">你</h6>
                                                <p class="mb-0 text-muted small">学习时长: 23小时</p>
                                            </div>
                                            <div class="points-badge rounded-pill py-1 px-2 bg-white text-primary fw-semibold">651分</div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 学习建议 -->
                <div class="row" data-aos="fade-up" data-aos-delay="400">
                    <div class="col-12">
                        <div class="card mb-4 border-0 overflow-hidden">
                            <div class="card-body p-0">
                                <div class="row g-0">
                                    <div class="col-md-8 p-4">
                                        <div class="d-flex">
                                            <div class="p-2 me-3 rounded-circle" style="background-color: rgba(67, 97, 238, 0.1);">
                                                <i class="bi bi-lightbulb text-primary"></i>
                                            </div>
                                            <div>
                                                <h5 class="card-title">AI学习助手</h5>
                                                <p class="card-text text-muted">根据您的学习情况和知识图谱分析，我们推荐以下内容：</p>
                                                
                                                <div class="recommendation-list mt-3">
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="recommendation-icon me-3 p-2 rounded-circle bg-light">
                                                            <i class="bi bi-journal-code text-primary"></i>
                                                        </div>
                                                        <div>
                                                            <h6 class="mb-0">深入学习分布式存储系统</h6>
                                                            <small class="text-muted">与您最近学习的内容相关</small>
                                                        </div>
                                                        <button class="btn btn-sm btn-outline-primary ms-auto">查看</button>
                                                    </div>
                                                    
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="recommendation-icon me-3 p-2 rounded-circle bg-light">
                                                            <i class="bi bi-pc-display text-success"></i>
                                                        </div>
                                                        <div>
                                                            <h6 class="mb-0">完成分布式存储系统实践案例</h6>
                                                            <small class="text-muted">应用您所学的知识</small>
                                                        </div>
                                                        <button class="btn btn-sm btn-outline-primary ms-auto">开始</button>
                                                    </div>
                                                    
                                                    <div class="d-flex align-items-center">
                                                        <div class="recommendation-icon me-3 p-2 rounded-circle bg-light">
                                                            <i class="bi bi-people text-warning"></i>
                                                        </div>
                                                        <div>
                                                            <h6 class="mb-0">加入"分布式存储研究"学习小组</h6>
                                                            <small class="text-muted">与其他学生一起讨论和学习</small>
                                                        </div>
                                                        <button class="btn btn-sm btn-outline-primary ms-auto">加入</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 position-relative d-none d-md-block">
                                        <div class="position-absolute" style="right:0; top:0; bottom:0; width:100%; overflow:hidden; z-index:0;">
                                            <div style="position:absolute; width:400px; height:400px; border-radius:50%; background:linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(76, 201, 240, 0.1)); right:-100px; top:-100px;"></div>
                                            <div style="position:absolute; width:300px; height:300px; border-radius:50%; background:linear-gradient(135deg, rgba(76, 201, 240, 0.05), rgba(67, 97, 238, 0.05)); right:-50px; bottom:-100px;"></div>
                                        </div>
                                        <div class="position-relative h-100 d-flex align-items-center justify-content-center">
                                            <img src="https://cdn-icons-png.flaticon.com/512/2021/2021646.png" alt="AI Assistant" class="img-fluid" style="max-width: 200px; z-index:1;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script th:src="@{/webjars/bootstrap/5.3.2/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/webjars/jquery/3.7.1/jquery.min.js}"></script>
    <script th:src="@{/webjars/d3js/5.16.0/d3.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
        // 初始化 AOS 动画库
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
        
        document.addEventListener('DOMContentLoaded', function() {
            // 侧边栏切换
            const toggleSidebar = document.getElementById('toggle-sidebar');
            const closeSidebar = document.getElementById('close-sidebar');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            if (toggleSidebar) {
                toggleSidebar.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                    mainContent.classList.toggle('sidebar-active');
                });
            }
            
            if (closeSidebar) {
                closeSidebar.addEventListener('click', function() {
                    sidebar.classList.remove('active');
                    mainContent.classList.remove('sidebar-active');
                });
            }
            
            // 移除图表加载状态
            setTimeout(() => {
                const loadingEl = document.querySelector('.graph-loading');
                if (loadingEl) {
                    loadingEl.classList.add('d-none');
                }
            }, 2000);
            
            // 初始化D3.js知识图谱示例
            initializeDemoGraph();
            
            // 初始化计数器动画
            initCounters();
            
            // 初始化图表
            initCharts();
            
            // 初始化下拉菜单
            initDropdowns();
            
            // 初始化学习进度时间范围选择
            initProgressTimeRangeSelector();
            
            // 初始化学习趋势切换
            initTrendViewSwitcher();

            // 初始化热门知识点时间范围选择
            initHotKnowledgeSelector();

            // 初始化高级数据分析时间段选择
            initEfficiencyPeriodSwitcher();

            // 初始化顶部导航栏用户选项
            initUserNavigation();

            // 初始化AI助手功能
            initAIAssistant();
        });
        
        // 计数器动画
        function initCounters() {
            const counterElements = document.querySelectorAll('.counter-animation');
            
            counterElements.forEach(counter => {
                const target = parseInt(counter.textContent);
                let count = 0;
                const duration = 2000; // 2秒内完成动画
                const frameRate = 30; // 每秒30帧
                const increment = Math.ceil(target / (duration / 1000 * frameRate));
                
                const timer = setInterval(() => {
                    count += increment;
                    
                    if (count >= target) {
                        counter.textContent = target.toLocaleString();
                        clearInterval(timer);
                    } else {
                        counter.textContent = count.toLocaleString();
                    }
                }, 1000 / frameRate);
            });
        }
        
        // 初始化学习进度时间范围选择
        function initProgressTimeRangeSelector() {
            // 获取所有时间范围选项
            const timeRangeItems = document.querySelectorAll('[data-time-range]');
            const progressTimeRangeBtn = document.getElementById('progressTimeRange');
            
            if (!timeRangeItems.length || !progressTimeRangeBtn) return;
            
            // 为每个选项添加点击事件
            timeRangeItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 获取选中的时间范围值
                    const timeRange = this.getAttribute('data-time-range');
                    
                    // 更新按钮文本
                    progressTimeRangeBtn.textContent = this.textContent;
                    
                    // 设置激活状态
                    timeRangeItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 根据选择的时间范围更新图表数据
                    updateProgressChart(timeRange);
                });
            });
        }
        
        // 更新学习进度图表
        function updateProgressChart(timeRange) {
            const chart = Chart.getChart('learningProgressChart');
            if (!chart) return;
            
            // 根据时间范围设置不同的数据
            let labels = [];
            let data = [];
            
            switch(timeRange) {
                case '30days':
                    labels = ['1日', '5日', '10日', '15日', '20日', '25日', '30日'];
                    data = [5, 12, 18, 25, 30, 35, 40];
                    break;
                case '3months':
                    labels = ['1月', '2月', '3月'];
                    data = [25, 40, 55];
                    break;
                case '6months':
                    labels = ['1月', '2月', '3月', '4月', '5月', '6月'];
                    data = [12, 19, 25, 32, 45, 56];
                    break;
                case '1year':
                    labels = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
                    data = [10, 15, 20, 25, 30, 40, 50, 60, 70, 80, 90, 100];
                    break;
                default:
                    // 默认显示6个月数据
                    labels = ['1月', '2月', '3月', '4月', '5月', '6月'];
                    data = [12, 19, 25, 32, 45, 56];
            }
            
            // 更新图表数据
            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            chart.update();
            
            // 更新学习知识点数量
            const progressValue = document.querySelector('.col-lg-6:first-child .card-body h3');
            if (progressValue) {
                progressValue.textContent = data[data.length - 1];
            }
        }
        
        // 初始化学习趋势切换
        function initTrendViewSwitcher() {
            // 获取周/月切换按钮
            const trendViewBtns = document.querySelectorAll('[data-trend-view]');
            
            if (!trendViewBtns.length) return;
            
            // 为每个按钮添加点击事件
            trendViewBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // 已经是活动状态则不处理
                    if (this.classList.contains('active')) return;
                    
                    // 获取视图类型
                    const viewType = this.getAttribute('data-trend-view');
                    
                    // 更新按钮状态
                    trendViewBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新图表数据
                    updateTrendChart(viewType);
                });
            });
        }
        
        // 更新学习趋势图表
        function updateTrendChart(viewType) {
            const chart = Chart.getChart('learningTrendChart');
            if (!chart) return;
            
            // 根据视图类型设置不同的数据
            let labels = [];
            let data = [];
            let comparisonText = '';
            
            if (viewType === 'week') {
                labels = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'];
                data = [2.5, 3.2, 1.8, 4.0, 2.8, 5.1, 3.7];
                comparisonText = '较上周';
                
                // 更新总学习时长
                const totalHours = document.querySelector('.col-lg-6:nth-child(3) .card-body h3');
                if (totalHours) {
                    totalHours.textContent = '23.4';
                }
                
            } else if (viewType === 'month') {
                labels = ['第1周', '第2周', '第3周', '第4周'];
                data = [12.5, 15.2, 18.6, 16.9];
                comparisonText = '较上月';
                
                // 更新总学习时长
                const totalHours = document.querySelector('.col-lg-6:nth-child(3) .card-body h3');
                if (totalHours) {
                    totalHours.textContent = '63.2';
                }
            }
            
            // 更新图表数据
            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            chart.update();
            
            // 更新比较文本
            const comparisonElement = document.querySelector('.col-lg-6:nth-child(3) .card-body .text-end p');
            if (comparisonElement) {
                comparisonElement.textContent = comparisonText;
            }
        }
        
        // 初始化下拉菜单
        function initDropdowns() {
            // 处理时间范围下拉菜单的选择
            const dropdownItems = document.querySelectorAll('.dropdown-menu .dropdown-item:not([data-time-range])');
            dropdownItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const parentDropdown = this.closest('.dropdown');
                    const dropdownToggle = parentDropdown.querySelector('.dropdown-toggle');
                    
                    // 更新按钮文本
                    dropdownToggle.textContent = this.textContent;
                    
                    // 更新活跃状态
                    dropdownItems.forEach(di => di.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 这里可以添加刷新图表的逻辑
                    // refreshChart();
                });
            });
            
            // 刷新分布图表按钮
            const refreshBtn = document.getElementById('refreshDistributionChart');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function() {
                    // 添加旋转动画
                    this.querySelector('i').classList.add('spin');
                    
                    // 更新图表数据
                    const chart = Chart.getChart('knowledgeDistributionChart');
                    if (chart) {
                        // 生成新的随机数据
                        const newData = [
                            Math.floor(Math.random() * 20) + 20, // 基础理论
                            Math.floor(Math.random() * 15) + 15, // 技术原理
                            Math.floor(Math.random() * 10) + 10, // 实践案例
                            Math.floor(Math.random() * 15) + 15, // 技术方法
                            Math.floor(Math.random() * 10) + 5   // 应用领域
                        ];
                        
                        chart.data.datasets[0].data = newData;
                        chart.update();
                        
                        // 更新图例百分比
                        const total = newData.reduce((a, b) => a + b, 0);
                        const legendItems = document.querySelectorAll('.chart-legend .small');
                        const categories = ['基础理论', '技术原理', '实践案例', '技术方法', '应用领域'];
                        
                        legendItems.forEach((item, index) => {
                            const percentage = Math.round((newData[index] / total) * 100);
                            item.textContent = `${categories[index]} (${percentage}%)`;
                        });
                        
                        // 2秒后移除旋转动画
                        setTimeout(() => {
                            this.querySelector('i').classList.remove('spin');
                        }, 2000);
                    }
                });
            }
            
            // 刷新新知识类型分布图表
            const refreshKnowledgeTypeBtn = document.getElementById('refreshKnowledgeTypeChart');
            if (refreshKnowledgeTypeBtn) {
                refreshKnowledgeTypeBtn.addEventListener('click', function() {
                    this.querySelector('i').classList.add('spin');
                    
                    const chart = Chart.getChart('knowledgeTypeDistributionChart');
                    if (chart) {
                        const newData = [
                            Math.floor(Math.random() * 15) + 35, // 技术方法
                            Math.floor(Math.random() * 10) + 25, // 基础理论
                            Math.floor(Math.random() * 10) + 20, // 实践案例
                            Math.floor(Math.random() * 5) + 10,  // 应用领域
                        ];
                        
                        chart.data.datasets[0].data = newData;
                        chart.update();
                        
                        setTimeout(() => {
                            this.querySelector('i').classList.remove('spin');
                        }, 2000);
                    }
                });
            }
        }
        
        function initializeDemoGraph() {
            const width = document.getElementById('knowledge-graph').clientWidth;
            const height = document.getElementById('knowledge-graph').clientHeight;
            
            // 创建SVG容器
            const svg = d3.select('#knowledge-graph')
                .append('svg')
                .attr('width', width)
                .attr('height', height);
                
            // 添加模糊效果滤镜
            const defs = svg.append('defs');
            
            // 添加发光效果
            const glowFilter = defs.append('filter')
                .attr('id', 'glow')
                .attr('x', '-50%')
                .attr('y', '-50%')
                .attr('width', '200%')
                .attr('height', '200%');
                
            glowFilter.append('feGaussianBlur')
                .attr('stdDeviation', '2.5')
                .attr('result', 'coloredBlur');
                
            const feMerge = glowFilter.append('feMerge');
            feMerge.append('feMergeNode')
                .attr('in', 'coloredBlur');
            feMerge.append('feMergeNode')
                .attr('in', 'SourceGraphic');
                
            // 模拟数据 - 在实际应用中应该从后端获取
            const nodes = [
                { id: 1, name: "大数据技术", group: 1, size: 20 },
                { id: 2, name: "数据处理", group: 1, size: 18 },
                { id: 3, name: "分布式计算", group: 1, size: 18 },
                { id: 4, name: "分布式存储", group: 2, size: 16 },
                { id: 5, name: "HDFS架构", group: 2, size: 16 },
                { id: 6, name: "MapReduce", group: 2, size: 14 },
                { id: 7, name: "强化学习", group: 3, size: 14 },
                { id: 8, name: "自然语言处理", group: 3, size: 14 },
                { id: 9, name: "计算机视觉", group: 3, size: 14 },
                { id: 10, name: "语音识别", group: 4, size: 12 },
                { id: 11, name: "迁移学习", group: 2, size: 13 },
                { id: 12, name: "生成对抗网络", group: 2, size: 15 },
                { id: 13, name: "图神经网络", group: 2, size: 13 },
                { id: 14, name: "注意力机制", group: 2, size: 14 },
                { id: 15, name: "Transformer", group: 2, size: 15 }
            ];
            
            const links = [
                { source: 1, target: 2, value: 5 },
                { source: 1, target: 3, value: 5 },
                { source: 2, target: 3, value: 4 },
                { source: 2, target: 4, value: 4 },
                { source: 3, target: 4, value: 5 },
                { source: 3, target: 5, value: 4 },
                { source: 3, target: 6, value: 4 },
                { source: 4, target: 5, value: 3 },
                { source: 4, target: 6, value: 3 },
                { source: 2, target: 7, value: 3 },
                { source: 3, target: 8, value: 3 },
                { source: 3, target: 9, value: 3 },
                { source: 8, target: 10, value: 2 },
                { source: 3, target: 11, value: 3 },
                { source: 3, target: 12, value: 4 },
                { source: 4, target: 13, value: 3 },
                { source: 4, target: 14, value: 4 },
                { source: 14, target: 15, value: 5 },
                { source: 6, target: 14, value: 4 },
                { source: 8, target: 15, value: 4 }
            ];
            
            // 创建力导向图
            const simulation = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-300))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .force("x", d3.forceX(width / 2).strength(0.1))
                .force("y", d3.forceY(height / 2).strength(0.1));
            
            // 创建渐变
            const gradients = defs.selectAll('.gradient')
                .data(['primary', 'secondary', 'accent', 'success'])
                .enter()
                .append('linearGradient')
                .attr('id', d => `gradient-${d}`)
                .attr('x1', '0%')
                .attr('y1', '0%')
                .attr('x2', '100%')
                .attr('y2', '100%');
                
            gradients.append('stop')
                .attr('offset', '0%')
                .attr('stop-color', d => {
                    if (d === 'primary') return '#4361ee';
                    if (d === 'secondary') return '#4cc9f0';
                    if (d === 'accent') return '#f72585';
                    if (d === 'success') return '#4ade80';
                    return '#4361ee';
                });
                
            gradients.append('stop')
                .attr('offset', '100%')
                .attr('stop-color', d => {
                    if (d === 'primary') return '#4895ef';
                    if (d === 'secondary') return '#4361ee';
                    if (d === 'accent') return '#b5179e';
                    if (d === 'success') return '#34d399';
                    return '#4895ef';
                });
            
            // 定义颜色
            const colorMap = {
                1: 'url(#gradient-primary)',
                2: 'url(#gradient-secondary)',
                3: 'url(#gradient-accent)',
                4: 'url(#gradient-success)'
            };
            
            // 创建连线
            const link = svg.append("g")
                .attr("class", "links")
                .selectAll("line")
                .data(links)
                .enter()
                .append("line")
                .attr("stroke-width", d => Math.sqrt(d.value))
                .attr("stroke", "#ddd")
                .attr("opacity", 0.6);
            
            // 创建节点
            const node = svg.append("g")
                .attr("class", "nodes")
                .selectAll("g")
                .data(nodes)
                .enter()
                .append("g")
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));
            
            // 添加圆形
            node.append("circle")
                .attr("r", d => d.size * 1.5)
                .attr("fill", d => colorMap[d.group])
                .attr("filter", "url(#glow)")
                .attr("stroke", "#fff")
                .attr("stroke-width", 2);
            
            // 添加文本标签
            node.append("text")
                .attr("dy", 4)
                .attr("text-anchor", "middle")
                .text(d => d.name)
                .attr("fill", "#fff")
                .attr("font-size", d => Math.min(2 * d.size, 30) + "%")
                .attr("font-weight", "600")
                .attr("pointer-events", "none");
            
            // 添加标题提示
            node.append("title")
                .text(d => d.name);
            
            // 更新位置
            simulation.on("tick", () => {
                link
                    .attr("x1", d => Math.max(20, Math.min(width - 20, d.source.x)))
                    .attr("y1", d => Math.max(20, Math.min(height - 20, d.source.y)))
                    .attr("x2", d => Math.max(20, Math.min(width - 20, d.target.x)))
                    .attr("y2", d => Math.max(20, Math.min(height - 20, d.target.y)));
                
                node
                    .attr("transform", d => {
                        const x = Math.max(20, Math.min(width - 20, d.x));
                        const y = Math.max(20, Math.min(height - 20, d.y));
                        return `translate(${x}, ${y})`;
                    });
            });
            
            // 拖拽函数
            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }
            
            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }
            
            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }
        
        function initCharts() {
            // 图表颜色配置
            const chartColors = {
                primary: '#4361ee',
                primaryLight: '#4895ef',
                secondary: '#4cc9f0',
                accent: '#f72585',
                success: '#4ade80',
                warning: '#fbbf24',
                danger: '#f43f5e',
                purple: '#8b5cf6',
                teal: '#2dd4bf',
                orange: '#fb923c',
                dark: '#1e293b',
                gray: '#64748b'
            };
            
            // 图表统一配置
            Chart.defaults.font.family = "'Poppins', 'Noto Sans SC', sans-serif";
            Chart.defaults.font.size = 12;
            Chart.defaults.plugins.tooltip.padding = 10;
            Chart.defaults.plugins.tooltip.backgroundColor = 'rgba(30, 41, 59, 0.8)';
            Chart.defaults.plugins.tooltip.titleFont = { size: 14, weight: 'bold' };
            Chart.defaults.plugins.tooltip.bodyFont = { size: 13 };
            Chart.defaults.plugins.tooltip.cornerRadius = 8;
            Chart.defaults.plugins.tooltip.displayColors = true;
            Chart.defaults.plugins.tooltip.boxPadding = 5;
            Chart.defaults.plugins.tooltip.usePointStyle = true;
            Chart.defaults.plugins.legend.display = false;
            
            // 学习进度图表
            const progressCtx = document.getElementById('learningProgressChart').getContext('2d');
            
            // 创建渐变背景
            const progressGradient = progressCtx.createLinearGradient(0, 0, 0, 300);
            progressGradient.addColorStop(0, 'rgba(67, 97, 238, 0.2)');
            progressGradient.addColorStop(1, 'rgba(67, 97, 238, 0.0)');
            
            const progressChart = new Chart(progressCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月'],
                    datasets: [{
                        label: '已学习知识点',
                        data: [12, 19, 25, 32, 45, 56, 65],
                        borderColor: chartColors.primary,
                        backgroundColor: progressGradient,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 6,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: chartColors.primary,
                        pointBorderWidth: 2,
                        pointHoverRadius: 8,
                        pointHoverBackgroundColor: chartColors.primary,
                        pointHoverBorderColor: '#fff',
                        pointHoverBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animations: {
                        tension: {
                            duration: 2000,
                            easing: 'linear'
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.y + ' 个知识点';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false,
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                padding: 10
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                padding: 10
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
            
            // 知识点分布图表
            const distributionCtx = document.getElementById('knowledgeDistributionChart').getContext('2d');
            const distributionChart = new Chart(distributionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['基础理论', '技术原理', '实践案例', '技术方法', '应用领域'],
                    datasets: [{
                        data: [30, 25, 15, 20, 10],
                        backgroundColor: [
                            chartColors.primary,
                            chartColors.secondary,
                            chartColors.danger,
                            chartColors.success,
                            chartColors.warning
                        ],
                        borderWidth: 0,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animations: {
                        animateScale: true,
                        animateRotate: true
                    },
                    cutout: '70%',
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // 学习趋势图表
            const trendCtx = document.getElementById('learningTrendChart').getContext('2d');
            
            // 创建渐变背景
            const trendGradient = trendCtx.createLinearGradient(0, 0, 0, 300);
            trendGradient.addColorStop(0, chartColors.primary);
            trendGradient.addColorStop(1, chartColors.secondary);
            
            const trendChart = new Chart(trendCtx, {
                type: 'bar',
                data: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    datasets: [{
                        label: '学习时长（小时）',
                        data: [2.5, 3.2, 1.8, 4.0, 2.8, 5.1, 3.7],
                        backgroundColor: trendGradient,
                        borderRadius: 8,
                        borderSkipped: false,
                        barThickness: 20,
                        hoverBackgroundColor: chartColors.purple
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.y + ' 小时';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false,
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                padding: 10
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                padding: 10
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutQuart'
                    }
                }
            });
            
            // 学习内容类型分布
            const typeCtx = document.getElementById('learningTypeChart').getContext('2d');
            const typeChart = new Chart(typeCtx, {
                type: 'polarArea',
                data: {
                    labels: ['理论学习', '视频课程', '实践案例', '测验题目', '互动讨论'],
                    datasets: [{
                        data: [30, 20, 25, 15, 10],
                        backgroundColor: [
                            chartColors.primary,
                            chartColors.danger,
                            chartColors.warning,
                            chartColors.success,
                            chartColors.purple
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            ticks: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.r + '%';
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
            
            // 新增: 学习效率比较图表
            const efficiencyCtx = document.getElementById('learningEfficiencyChart');
            if (efficiencyCtx) {
                // 创建渐变背景
                const efficiencyGradient = efficiencyCtx.getContext('2d').createLinearGradient(0, 0, 0, 300);
                efficiencyGradient.addColorStop(0, 'rgba(139, 92, 246, 0.3)');
                efficiencyGradient.addColorStop(1, 'rgba(139, 92, 246, 0.0)');
                
                const efficiencyChart = new Chart(efficiencyCtx, {
                    type: 'line',
                    data: {
                        labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                        datasets: [
                            {
                                label: '本周效率',
                                data: [75, 82, 78, 85, 90, 87, 88],
                                borderColor: chartColors.purple,
                                backgroundColor: efficiencyGradient,
                                tension: 0.4,
                                fill: true,
                                pointRadius: 5,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: chartColors.purple,
                                pointBorderWidth: 2,
                            },
                            {
                                label: '上周效率',
                                data: [68, 72, 75, 80, 78, 82, 79],
                                borderColor: chartColors.gray,
                                borderDash: [5, 5],
                                tension: 0.4,
                                fill: false,
                                pointRadius: 4,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: chartColors.gray,
                                pointBorderWidth: 2,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y + '%';
                                    }
                                }
                            },
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    boxWidth: 10,
                                    boxHeight: 10
                                }
                            }
                        },
                        scales: {
                            y: {
                                min: 50,
                                max: 100,
                                ticks: {
                                    stepSize: 10
                                },
                                grid: {
                                    drawBorder: false,
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
            
            // 新增: 知识点类型分布图表
            const knowledgeTypeCtx = document.getElementById('knowledgeTypeDistributionChart');
            if (knowledgeTypeCtx) {
                const knowledgeTypeChart = new Chart(knowledgeTypeCtx, {
                    type: 'bar',
                    data: {
                        labels: ['技术方法', '基础理论', '实践案例', '应用领域'],
                        datasets: [{
                            label: '占比 (%)',
                            data: [42, 30, 28, 10],
                            backgroundColor: [
                                chartColors.primary,
                                chartColors.secondary,
                                chartColors.accent,
                                chartColors.warning
                            ],
                            borderWidth: 0,
                            borderRadius: 6,
                            barThickness: 30
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.parsed.x + '%';
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 50,
                                grid: {
                                    drawBorder: false,
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            y: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
            
            // 新增: 年度学习趋势图表
            const yearlyTrendCtx = document.getElementById('yearlyLearningTrendChart');
            if (yearlyTrendCtx) {
                // 创建渐变背景
                const ctx = yearlyTrendCtx.getContext('2d');
                const yearlyGradient1 = ctx.createLinearGradient(0, 0, 0, 300);
                yearlyGradient1.addColorStop(0, 'rgba(74, 222, 128, 0.6)');
                yearlyGradient1.addColorStop(1, 'rgba(74, 222, 128, 0.0)');
                
                const yearlyGradient2 = ctx.createLinearGradient(0, 0, 0, 300);
                yearlyGradient2.addColorStop(0, 'rgba(67, 97, 238, 0.6)');
                yearlyGradient2.addColorStop(1, 'rgba(67, 97, 238, 0.0)');
                
                const yearlyTrendChart = new Chart(yearlyTrendCtx, {
                    type: 'line',
                    data: {
                        labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                        datasets: [
                            {
                                label: '今年',
                                data: [20, 25, 35, 42, 50, 65, 75, 82, 90, 95, 105, 110],
                                borderColor: chartColors.success,
                                backgroundColor: yearlyGradient1,
                                tension: 0.4,
                                fill: true,
                                pointRadius: 5,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: chartColors.success
                            },
                            {
                                label: '去年',
                                data: [15, 20, 25, 30, 40, 52, 60, 70, 75, 80, 85, 90],
                                borderColor: chartColors.primary,
                                backgroundColor: yearlyGradient2,
                                tension: 0.4,
                                fill: true,
                                pointRadius: 5,
                                pointBackgroundColor: '#fff',
                                pointBorderColor: chartColors.primary
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y + ' 知识点';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    drawBorder: false,
                                    color: 'rgba(0, 0, 0, 0.05)'
                                },
                                ticks: {
                                    padding: 10
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    padding: 10
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }
        }

        // 初始化热门知识点时间范围选择
        function initHotKnowledgeSelector() {
            const hotKnowledgeSelect = document.getElementById('hotKnowledgeTimeRange');
            if (!hotKnowledgeSelect) return;

            hotKnowledgeSelect.addEventListener('change', function() {
                updateHotKnowledgeList(this.value);
            });
        }

        // 更新热门知识点列表
        function updateHotKnowledgeList(timeRange) {
            const knowledgeList = document.getElementById('hotKnowledgeList');
            if (!knowledgeList) return;

            // 模拟不同时间范围的数据
            let items = '';
            
            if (timeRange === 'week') {
                items = `
                    <li class="list-group-item px-0">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <div class="me-3 text-center" style="width: 30px;">
                                    <span class="badge rounded-pill bg-primary">1</span>
                                </div>
                                <div>
                                    <h6 class="mb-0 fw-semibold">HDFS架构</h6>
                                    <small class="text-muted">相关实体: 28个</small>
                                </div>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">120次访问</span>
                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                    <div class="progress-bar" role="progressbar" style="width: 85%; background: var(--gradient-primary);" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <!-- 本周其他数据 -->
                `;
            } else if (timeRange === 'month') {
                items = `
                    <li class="list-group-item px-0">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <div class="me-3 text-center" style="width: 30px;">
                                    <span class="badge rounded-pill bg-primary">1</span>
                                </div>
                                <div>
                                    <h6 class="mb-0 fw-semibold">分布式存储系统</h6>
                                    <small class="text-muted">相关实体: 42个</small>
                                </div>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">256次访问</span>
                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                    <div class="progress-bar" role="progressbar" style="width: 92%; background: var(--gradient-primary);" aria-valuenow="92" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <!-- 本月其他数据 -->
                `;
            } else if (timeRange === 'all') {
                items = `
                    <li class="list-group-item px-0">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <div class="me-3 text-center" style="width: 30px;">
                                    <span class="badge rounded-pill bg-primary">1</span>
                                </div>
                                <div>
                                    <h6 class="mb-0 fw-semibold">大数据技术概论</h6>
                                    <small class="text-muted">相关实体: 56个</small>
                                </div>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-light text-primary rounded-pill py-2 px-3">453次访问</span>
                                <div class="progress mt-1" style="width: 100px; height: 4px;">
                                    <div class="progress-bar" role="progressbar" style="width: 98%; background: var(--gradient-primary);" aria-valuenow="98" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <!-- 所有时间其他数据 -->
                `;
            }
            
            // 更新列表内容
            knowledgeList.innerHTML = items;
            
            // 添加动画效果
            const listItems = knowledgeList.querySelectorAll('.list-group-item');
            listItems.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    item.style.transition = 'all 0.3s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, 100 * index);
            });
        }

        // 初始化高级数据分析时间段选择
        function initEfficiencyPeriodSwitcher() {
            const periodBtns = document.querySelectorAll('[data-period]');
            if (!periodBtns.length) return;

            periodBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // 已经是活动状态则不处理
                    if (this.classList.contains('active')) return;
                    
                    // 获取时间段类型
                    const periodType = this.getAttribute('data-period');
                    
                    // 更新按钮状态
                    periodBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新图表数据
                    updateEfficiencyChart(periodType);
                });
            });
        }

        // 更新学习效率比较图表
        function updateEfficiencyChart(periodType) {
            const chart = Chart.getChart('learningEfficiencyChart');
            if (!chart) return;
            
            const efficiencyValue = document.getElementById('efficiency-value');
            const efficiencyChange = document.getElementById('efficiency-change');
            const efficiencyPeriod = document.getElementById('efficiency-period');
            
            // 根据时间段类型设置不同的数据
            let labels = [];
            let data = [];
            let value = '';
            let change = '';
            let period = '';
            
            if (periodType === 'week') {
                labels = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'];
                data = [75, 82, 79, 84, 88, 85, 92];
                value = '85.2%';
                change = '+8.5%';
                period = '较上周';
                
                // 保持为正值，显示为绿色
                efficiencyChange.classList.remove('bg-danger');
                efficiencyChange.classList.add('bg-success');
                
            } else if (periodType === 'month') {
                labels = ['第1周', '第2周', '第3周', '第4周'];
                data = [70, 75, 82, 79];
                value = '76.5%';
                change = '-2.8%';
                period = '较上月';
                
                // 负值显示为红色
                efficiencyChange.classList.remove('bg-success');
                efficiencyChange.classList.add('bg-danger');
                
            } else if (periodType === 'year') {
                labels = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
                data = [65, 68, 70, 72, 75, 78, 80, 82, 85, 88, 90, 92];
                value = '92.0%';
                change = '+15.3%';
                period = '较去年';
                
                // 保持为正值，显示为绿色
                efficiencyChange.classList.remove('bg-danger');
                efficiencyChange.classList.add('bg-success');
            }
            
            // 更新图表数据
            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            chart.update();
            
            // 更新显示值
            if (efficiencyValue) efficiencyValue.textContent = value;
            if (efficiencyChange) efficiencyChange.textContent = change;
            if (efficiencyPeriod) efficiencyPeriod.textContent = period;
        }

        // 初始化顶部导航栏用户选项
        function initUserNavigation() {
            // 个人资料链接
            const profileLink = document.getElementById('profileLink');
            if (profileLink) {
                profileLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    showPageLoadingEffect();
                    setTimeout(() => {
                        alert('正在跳转到个人资料页面...');
                    }, 500);
                });
            }
            
            // 账号设置链接
            const settingsLink = document.getElementById('settingsLink');
            if (settingsLink) {
                settingsLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    showPageLoadingEffect();
                    setTimeout(() => {
                        alert('正在跳转到账号设置页面...');
                    }, 500);
                });
            }
            
            // 帮助中心链接
            const helpLink = document.getElementById('helpLink');
            if (helpLink) {
                helpLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    showPageLoadingEffect();
                    setTimeout(() => {
                        alert('正在跳转到帮助中心页面...');
                    }, 500);
                });
            }
        }

        // 模拟页面加载效果
        function showPageLoadingEffect() {
            // 创建页面加载动画元素
            const loadingDiv = document.createElement('div');
            loadingDiv.classList.add('page-loading-overlay');
            loadingDiv.innerHTML = `
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
            `;
            loadingDiv.style.position = 'fixed';
            loadingDiv.style.top = '0';
            loadingDiv.style.left = '0';
            loadingDiv.style.width = '100%';
            loadingDiv.style.height = '100%';
            loadingDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
            loadingDiv.style.display = 'flex';
            loadingDiv.style.justifyContent = 'center';
            loadingDiv.style.alignItems = 'center';
            loadingDiv.style.zIndex = '9999';
            
            document.body.appendChild(loadingDiv);
            
            // 2秒后移除加载动画
            setTimeout(() => {
                document.body.removeChild(loadingDiv);
            }, 2000);
        }

        // 初始化AI助手功能
        function initAIAssistant() {
            const aiAssistantBtn = document.getElementById('aiAssistantBtn');
            const aiAssistantPanel = document.getElementById('aiAssistantPanel');
            const closeAiAssistant = document.getElementById('closeAiAssistant');
            const chatInput = document.getElementById('chatInput');
            const sendMessageBtn = document.getElementById('sendMessageBtn');
            const chatMessages = document.getElementById('chatMessages');
            const suggestionBtns = [
                document.getElementById('suggestionBtn1'),
                document.getElementById('suggestionBtn2'),
                document.getElementById('suggestionBtn3')
            ];
            
            if (!aiAssistantBtn || !aiAssistantPanel) return;
            
            // 切换AI助手面板显示/隐藏
            aiAssistantBtn.addEventListener('click', function() {
                aiAssistantPanel.style.display = 'block';
            });
            
            // 关闭AI助手面板
            if (closeAiAssistant) {
                closeAiAssistant.addEventListener('click', function() {
                    aiAssistantPanel.style.display = 'none';
                });
            }
            
            // 发送消息
            if (sendMessageBtn && chatInput && chatMessages) {
                sendMessageBtn.addEventListener('click', function() {
                    sendMessage();
                });
                
                // 回车键发送消息
                chatInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        sendMessage();
                    }
                });
                
                // 快捷问题按钮
                suggestionBtns.forEach(btn => {
                    if (btn) {
                        btn.addEventListener('click', function() {
                            if (chatInput) {
                                chatInput.value = this.textContent;
                                sendMessage();
                            }
                        });
                    }
                });
                
                // 发送消息函数
                function sendMessage() {
                    const message = chatInput.value.trim();
                    if (!message) return;
                    
                    // 添加用户消息
                    const currentTime = getCurrentTime();
                    const userMessageHTML = `
                        <div class="chat-message user-message mb-3 text-end">
                            <div class="message-content p-3 rounded bg-primary text-white" style="display: inline-block; max-width: 80%; text-align: left;">
                                <p class="mb-0">${message}</p>
                            </div>
                            <small class="text-muted">${currentTime}</small>
                        </div>
                    `;
                    chatMessages.insertAdjacentHTML('beforeend', userMessageHTML);
                    
                    // 清空输入框
                    chatInput.value = '';
                    
                    // 滚动到底部
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // 模拟AI回复
                    setTimeout(() => {
                        // 根据不同问题生成不同回复
                        let aiReply = '';
                        
                        if (message.includes('图谱') || message.includes('知识图谱')) {
                            aiReply = '分布式存储系统是一种表示分布式环境中数据存储和访问方法的方法。在我们的系统中，分布式存储系统展示了不同知识点之间的关联，帮助你理解学习路径和知识结构。你可以在图谱浏览页面中交互式地探索知识点关系。';
                        } else if (message.includes('路径') || message.includes('学习路径')) {
                            aiReply = '基于你的学习历史和兴趣，我推荐以下学习路径：1. 从"大数据基础"开始，2. 学习"分布式存储系统"，3. 深入了解"分布式计算框架"，4. 最后掌握"数据分析与可视化"。你可以在系统中查看完整的学习路径推荐。';
                        } else if (message.includes('难点') || message.includes('解释')) {
                            aiReply = '分布式系统中的"数据一致性"是一个常见的难点概念。简单来说，它是确保分布式环境中多个节点上的数据副本保持一致的机制，通过共识算法(如Paxos、Raft)实现可靠的数据复制和更新。如需更详细的解释，可以查看相关学习资源。';
                        } else {
                            aiReply = '感谢你的提问！我会尽力为你提供帮助。对于具体的课程内容或知识点，你可以在系统中查询详细信息，或者我可以为你提供相关资源的链接。';
                        }
                        
                        // 添加AI回复
                        const aiMessageHTML = `
                            <div class="chat-message ai-message mb-3">
                                <div class="message-content p-3 rounded" style="display: inline-block; background-color: #e9ecef; max-width: 80%;">
                                    <p class="mb-0">${aiReply}</p>
                                </div>
                                <small class="text-muted">${getCurrentTime()}</small>
                            </div>
                        `;
                        chatMessages.insertAdjacentHTML('beforeend', aiMessageHTML);
                        
                        // 滚动到底部
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 1000);
                }
                
                // 获取当前时间
                function getCurrentTime() {
                    const now = new Date();
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    return `今天 ${hours}:${minutes}`;
                }
            }
        }
    </script>
    
    <style>
        /* 知识地图样式 */
        .knowledge-map-stage {
            position: relative;
        }
        
        /* ... existing code ... */
        
        /* 新增动画效果 */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .spin {
            animation: spin 2s linear infinite;
        }
        
        .cornea-reflection {
            position: relative;
            overflow: hidden;
        }
        
        .cornea-reflection::before {
            content: '';
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            filter: blur(10px);
            top: -25px;
            left: -25px;
            z-index: 0;
            animation: moveReflection 8s ease-in-out infinite;
        }
        
        @keyframes moveReflection {
            0% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(200%) translateY(50%); }
            50% { transform: translateX(150%) translateY(200%); }
            75% { transform: translateX(50%) translateY(150%); }
            100% { transform: translateX(0) translateY(0); }
        }
        
        /* 眨眼动画效果 */
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .iris-button {
            animation: blink 5s ease-in-out infinite;
        }
        
        @keyframes ping-slow {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.5); opacity: 0.5; }
            100% { transform: scale(0.5); opacity: 0; }
        }
        
        .animate-ping-slow {
            animation: ping-slow 3s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
    </style>
    
    <!-- 悬浮助手按钮 -->
    <div class="floating-assistant iris-button">
        <i class="bi bi-robot"></i>
        <div class="assistant-ping animate"></div>
    </div>

    <!-- AI 助手聊天界面 -->
    <div class="ai-assistant-panel" id="aiAssistantPanel" style="display: none; position: fixed; right: 0; top: 0; width: 350px; height: 100vh; background: white; box-shadow: -5px 0 15px rgba(0,0,0,0.1); z-index: 1050; overflow: hidden; transition: all 0.3s ease;">
        <div class="d-flex flex-column h-100">
            <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <div class="me-2 p-2 rounded-circle bg-primary bg-opacity-10">
                        <i class="bi bi-robot text-primary"></i>
                    </div>
                    <h5 class="mb-0">AI 学习助手</h5>
                </div>
                <button class="btn-close" id="closeAiAssistant"></button>
            </div>
            
            <div class="p-3 flex-grow-1 overflow-auto" id="chatMessages" style="background-color: #f8f9fa;">
                <div class="chat-message ai-message mb-3">
                    <div class="message-content p-3 rounded">
                        <p class="mb-0">你好！我是你的 AI 学习助手。有任何关于课程或知识点的问题，都可以问我。</p>
                    </div>
                    <small class="text-muted">今天 10:00</small>
                </div>
            </div>
            
            <div class="p-3 border-top">
                <div class="input-group">
                    <input type="text" class="form-control" id="chatInput" placeholder="输入你的问题...">
                    <button class="btn btn-primary" id="sendMessageBtn">
                        <i class="bi bi-send"></i>
                    </button>
                </div>
                <div class="d-flex justify-content-around mt-2">
                    <button class="btn btn-sm btn-light" id="suggestionBtn1">分布式存储系统介绍</button>
                    <button class="btn btn-sm btn-light" id="suggestionBtn2">推荐学习路径</button>
                    <button class="btn btn-sm btn-light" id="suggestionBtn3">解释难点概念</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 